From 2bf03e69c8b679eec90826012da4a63afb193872 Mon Sep 17 00:00:00 2001
From: CyrIng <labs@cyring.fr>
Date: Fri, 11 Feb 2022 00:26:54 +0100
Subject: [PATCH] Solving compilation with CONFIG_SCHED_ALT (issue #322)

---
 corefreqk.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/corefreqk.c b/corefreqk.c
index 163e722..82b3360 100644
--- a/corefreqk.c
+++ b/corefreqk.c
@@ -10394,8 +10394,9 @@ void Sys_DumpTask(SYSGATE_RO *SysGate)
 #else
 		SysGate->taskList[cnt].state    = (short int) thread->__state;
 #endif
-#if defined(CONFIG_SCHED_BMQ) \
- || defined(CONFIG_SCHED_PDS)
+#if defined(CONFIG_SCHED_ALT)
+		SysGate->taskList[cnt].wake_cpu = (short int) task_cpu(thread);
+#elif defined(CONFIG_SCHED_BMQ) || defined(CONFIG_SCHED_PDS)
 		SysGate->taskList[cnt].wake_cpu = (short int) thread->cpu;
 #else
 		SysGate->taskList[cnt].wake_cpu = (short int) thread->wake_cpu;
-- 
2.35.1

